---
title: 注册事件
sidebar_position: 1
---

# 注册事件处理器

## jade_on

注册一个事件处理器，当指定事件触发时，回调函数将被调用。

### 函数签名

```c
uint32_t jade_on(const char* event_name, IpcCallback callback);
```

### 参数说明

| 参数 | 类型 | 说明 |
|------|------|------|
| `event_name` | const char* | 事件名称 |
| `callback` | IpcCallback | 事件回调函数 |

### 返回值说明

返回注册的回调 ID，如果注册失败返回 0。

### 功能描述

注册一个事件处理器，当指定事件触发时，回调函数将被调用。

### 使用示例

```c
// 事件回调函数
int event_callback(uint32_t window_id, const char* event_data) {
    printf("事件触发：window_id=%u, data=%s\n", window_id, event_data);
    return 1;
}

// 注册 app-ready 事件处理器
uint32_t callback_id = jade_on("app-ready", event_callback);

if (callback_id == 0) {
    printf("事件注册失败\n");
} else {
    printf("事件注册成功，回调 ID：%u\n", callback_id);
}
```

## jade_off

注销指定事件的指定回调处理器。

### 函数签名

```c
int jade_off(const char* event_name, uint32_t callback_id);
```

### 参数说明

| 参数 | 类型 | 说明 |
|------|------|------|
| `event_name` | const char* | 事件名称 |
| `callback_id` | uint32_t | 要注销的回调 ID |

### 返回值说明

| 返回值 | 说明 |
|---------|------|
| `1` | 成功 |
| `0` | 失败 |

### 功能描述

注销指定事件的指定回调处理器。

### 使用示例

```c
// 注销 app-ready 事件的回调处理器
int result = jade_off("app-ready", callback_id);

if (result == 1) {
    printf("事件注销成功\n");
} else {
    printf("事件注销失败\n");
}
```

## register_ipc_handler

兼容旧版本的 IPC 注册函数，用于注册 IPC 通道的回调处理器。

### 函数签名

```c
int register_ipc_handler(const char* channel, IpcCallback ipc_cb);
```

### 参数说明

| 参数 | 类型 | 说明 |
|------|------|------|
| `channel` | const char* | IPC 通道名称 |
| `ipc_cb` | IpcCallback | IPC 回调函数 |

### 返回值说明

| 返回值 | 说明 |
|---------|------|
| `1` | 成功 |
| `0` | 失败 |

### 功能描述

兼容旧版本的 IPC 注册函数，用于注册 IPC 通道的回调处理器。

### 使用示例

```c
// IPC 回调函数
int ipc_callback(uint32_t window_id, const char* message) {
    printf("IPC 消息：window_id=%u, message=%s\n", window_id, message);
    return 1;
}

// 注册 test-channel 通道的 IPC 处理器
int result = register_ipc_handler("test-channel", ipc_callback);

if (result == 1) {
    printf("IPC 处理器注册成功\n");
} else {
    printf("IPC 处理器注册失败\n");
}
```

### 回调函数类型

#### IpcCallback

```c
typedef int (*IpcCallback)(uint32_t window_id, const char* event_data);
```

**参数说明：**
- `window_id`：窗口 ID
- `event_data`：事件数据，UTF-8 字符串

**返回值说明：**
- `1`：成功处理
- `0`：处理失败
